name: Deployment

on:
  workflow_call:

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ✅ DEBUG — Capture Real Actor in WF2
        run: |
          echo "WF2 github.actor = ${{ github.actor }}"
          echo "WF2 event = ${{ github.event_name }}"

      - name: Trigger Master Product List Update (Workflow 3)
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          ACTOR: ${{ github.actor }}
        run: |
          echo "Passing ACTOR to WF3: $ACTOR"

          curl -X POST \
            -H "Authorization: Bearer $GITHUB_TOKEN" \
            -H "Accept: application/vnd.github+json" \
            https://api.github.com/repos/${{ github.repository }}/actions/workflows/masterproductlist-update.yaml/dispatches \
            -d "{
              \"ref\": \"main\",
              \"inputs\": {
                \"pr_actor\": \"$ACTOR\"
              }
            }"
